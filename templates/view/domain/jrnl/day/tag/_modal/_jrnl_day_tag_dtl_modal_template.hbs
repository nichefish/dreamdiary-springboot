 <#--
 * 저널 일자 (jrnl_day) > 상세 Template
 * @included_in : _jrnl_day_tag_dtl_modal.ftlh
 -->

<script type="text/x-handlebars-template" id="jrnl_day_tag_dtl_modal_template">
    {{#each this}}
        {{^if (equals this.mnth (lookup @root._locals "prevMnth"))}}
            <div class="d-flex-center mt-6 mb-4 fs-5 text-dark">{{yy}}년 {{mnth}}월</div>
        {{/if}}

        <div class="jrnl-item">
            <div class="col-12 col-md-1 d-flex flex-wrap align-items-center fs-5 fw-bold">
                {{> jrnl_day_stdrd_dt_partial this}}
                {{> jrnl_day_context_btn_partial this postNo=this.jrnlDayNo}}
            </div>
            <div class="col py-3 d-flex d-flex flex-column">
                <div class="flex-row mb-2">
                    {{#if (exists tag.list)}}
                        <div class="ms-2">
                            {{#tag.list}}
                                {{> tag_list_partial this module="dF.JrnlDayTag"}}
                            {{/tag.list}}
                        </div>
                    {{/if}}
                </div>
                <div class="flex-row mb-2">
                    {{#if (exists comment.list)}}
                        <div class="row pb-2">
                            <div class="col-1 w-130px"></div>
                            <div class="col ms-10 text-noti">
                                {{#each comment.list}}
                                    {{> comment_list_partial this}}
                                {{/each}}
                            </div>
                        </div>
                    {{/if}}
                </div>

                <div class="flex-row">
                    {{#each jrnlEntryList}}
                        <div class="d-flex align-items-center mt-2">
                            <div class="col col-md-1 w-5 text-gray-700 fs-6 ps-1 ps-md-5 fw-bolder ">
                                {{#ifYn entryResolvedYn}}
                                    <span class="text-success"><@spring.message 'txt.entry'/></span>
                                    <span class="position-relative d-inline-block">
                                      <i class="bi bi-book fs-4 text-success"></i>
                                      <i class="bi bi-check fs-2 text-success position-absolute top-25 start-50 translate-middle"></i>
                                    </span>
                                {{else}}
                                    <@spring.message 'txt.entry'/>
                                    <i class="bi bi-book fs-4 pe-1"></i>
                                {{/ifYn}}
                            </div>
                            <div class="col-3 d-none d-md-flex align-items-center gap-2">
                                {{> jrnl_diary_reg_btn_partial this}}
                                {{> jrnl_entry_context_btn_partial this}}
                                {{> jrnl_entry_toggle_btn_partial this}}
                            </div>
                        </div>
                        <div class="jrnl-entry jrnl-item" data-id={{postNo}}>
                            {{#each jrnlDiaryList}}
                                <div class="jrnl-diary-item" data-id={{postNo}} data-collapsed="{{collapsedYn}}" data-resolved="{{resolvedYn}}" data-imprtc="{{imprtcYn}}">
                                    <div class="col-1 py-3 d-none d-md-flex-between border-2 border-gray-300 border-end ps-5 me-4 h-75" style="width:85px;">
                                        <div class="d-flex flex-column align-items-center">
                                            <span class="jrnl-diary-idx {{#ifYn resolvedYn}}text-success{{/ifYn}}">
                                                # {{idx}}
                                                {{#ifYn resolvedYn}}
                                                    <i class="bi bi-check fs-2 text-success position-absolute top-25 start-50 translate-middle"></i>
                                                {{/ifYn}}
                                            </span>
                                            {{> jrnl_diary_toggle_btn_partial this}}
                                        </div>
                                    </div>
                                    <div class="col jrnl-diary-cn {{#ifYn imprtcYn}}bg-secondary{{/ifYn}}">
                                        {{> jrnl_diary_cn_partial this}}
                                    </div>
                                    <div class="col-1 ms-4 d-none d-md-flex border-2 border-gray-300 border-end h-75 w-10px">&nbsp;</div>
                                    <div class="col-1 py-3 d-none d-md-flex-between w-75px ps-2 gap-1">
                                        {{> comment_reg_btn_partial this contentType="JRNL_DIARY"}}
                                        {{> jrnl_diary_copy_btn_partial this}}
                                        {{> jrnl_diary_context_btn_partial this}}
                                    </div>
                                </div>
                            {{/each}}
                        </div>
                    {{/each}}
                    {{#if hasDream}}
                        <div class="d-flex align-items-center mt-2">
                            <span class="text-gray-700 fs-6 ps-1 ps-md-5 fw-bolder">
                                <@spring.message 'txt.dream'/>
                                <i class="bi bi-moon-stars fs-4 pe-1"></i>
                            </span>
                        </div>
                        {{#each jrnlDreamList}}
                            <div class="jrnl-item">
                                <div class="col-1 py-3 d-none d-md-flex-between border-2 border-gray-300 border-end ps-10 me-4 h-75" style="width:85px;">
                                    <div># {{idx}}</div>
                                </div>
                                <div class="col py-3 jrnl-dream-cn {{#ifYn imprtcYn}}bg-secondary{{/ifYn}}">
                                    {{> jrnl_dream_cn_partial this collapse="collapse-4"}}
                                </div>
                                <div class="col-1 bd-none d-md-flex order-2 border-gray-300 border-end h-75 w-10px">&nbsp;</div>
                                <div class="col-1 py-3 d-none d-md-flex-between w-75px gap-1">
                                    {{> comment_reg_btn_partial this contentType="JRNL_DREAM"}}
                                    {{> jrnl_dream_copy_btn_partial this}}
                                    {{> jrnl_dream_context_btn_partial this}}
                                </div>
                            </div>
                        {{/each}}
                        {{#each jrnlElseDreamList}}
                            <div class="jrnl-item">
                                <div class="col-1 py-3 d-none d-md-flex border-2 border-gray-300 border-end ps-10 me-4 h-75" style="width:85px;">
                                    -
                                </div>
                                <div class="col py-3 jrnl-dream-cn bg-secondary">
                                    {{> jrnl_dream_cn_partial this collapse="collapse-4" elseDreamYn="Y"}}
                                </div>
                                <div class="col-1 d-none d-md-flex border-2 border-gray-300 border-end h-75 w-10px">&nbsp;</div>
                                <div class="col-1 py-3 d-none d-md-flex-between w-75px gap-1">
                                    {{> comment_reg_btn_partial this contentType="JRNL_DREAM"}}
                                    {{> jrnl_dream_copy_btn_partial this}}
                                    {{> jrnl_dream_context_btn_partial this}}
                                </div>
                            </div>
                        {{/each}}
                    {{/if}}
                </div>
            </div>
            <div class="col-1 w-50px"></div>
        </div>

        {{!-- 현재 월을 previousMnth 변수로 저장 --}}
        {{set "prevMnth" this.mnth}}
    </div>
    {{/each}}
</script>